*{<meta charset="utf-8">}*
#{extends 'Application/header.html' /}
<h2>マイページ</h2>

<div id="news-block" class="sans-serif">
	<h3>お知らせ</h3>
	<p class="note">${unread_news.size()}件のお知らせがあります。</p>
	<a class="seeMore" href="@{news()}">過去のお知らせを見る</a>
	<table class="table table-bordered">
		<tbody>
		#{list items: unread_news, as: 'news'}
			<tr>
				<td>${news.date.getMonth()+1}/${news.date.getDate()}</td>
				<td><a href=${news.getLink()}>${news.getSentence()}</a></td>
			</tr>
		#{/list}
		</tbody>
	</table>
</div>

<form action="makeProject">
	<input class="makeproject-btn btn" type="submit" value="プロジェクト作成">
</form>

<div id="invited-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>招待されているプロジェクト</h3>
	#{if InR.size()==0 && IR.size()==0}
	<p>プロジェクトはありません。</p>
	#{/if}
	#{else}
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>締め切り</th>
				<th>登録</th>
			</tr>
			<!-- 招待された登録未完了 -->
			#{list items:InR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.getDeadlineTime()}</td>
				<td class="column-3"><a class="register-btn btn" href="@{register(ele.id)}">登録する</a></td>
			</tr>
			#{/list}
			<!-- 招待された登録完了 -->
			#{list items:IR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.getDeadlineTime()}</td>
				<td class="column-3">登録済み<br><a class="note" href="@{register(ele.id)}">再登録する</a></td>
			</tr>
			#{/list}
		</tbody>
	</table>
	#{/else}
</div>

<div id="created-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>作成したプロジェクト</h3>
	#{if MP.size()==0}
	<p>プロジェクトはありません。</p>
	#{/if}
	#{else}
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>締め切り</th>
				<th>登録</th>
			</tr>
			<!-- 作成したプロジェクト -->
			#{list items:MP, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.getDeadlineTime()}</td>
				<td class="column-3">
				#{if !ele.isFinished()}
					<a class="edit-btn btn" href="@{editProject(ele.id)}">編集する</a>
				#{/if}
				#{else}
					<a class="result-btn btn" href="@{result(ele.id)}">結果を見る</a>
				#{/else}
				</td>
			</tr>
			#{/list}
			<!-- <tr>
				<td class="column-1"><a href="@{project()}">グループ振り分け</a></td>
				<td class="column-2">終了</td>
				<td class="column-3"><a class="result-btn btn" href="@{result()}">結果を見る</a></td>
			</tr> -->
		</tbody>
	</table>
	#{/else}
</div>

<div id="join-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>参加したプロジェクト</h3>
	#{if FnR.size()==0 && FR.size()==0}
	<p>プロジェクトはありません。</p>
	#{/if}
	#{else}
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>あなたのグループ</th>
				<th>登録</th>
			</tr>
			<!-- 終了した登録未完了 -->
			#{list items:FnR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">
					#{if ug_map.get(ele.id)==null}
						なし
					#{/if}
					#{else}
						${ug_map.get(ele.id).name}
					#{/else}
				</td>
				<td class="column-3"><a class="result-btn btn" href="@{result(ele.id)}">結果を見る</a></td>
			</tr>
			#{/list}
			<!-- 終了した登録完了 -->
			#{list items:FR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">
					#{if ug_map.get(ele.id)==null}
						なし
					#{/if}
					#{else}
						${ug_map.get(ele.id).name}
					#{/else}
				</td>
				<td class="column-3"><a class="result-btn btn" href="@{result(ele.id)}">結果を見る</a></td>
			</tr>
			#{/list}
		</tbody>
	</table>
	#{/else}

</div>
