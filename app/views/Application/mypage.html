*{<meta charset="utf-8">}*
#{extends 'Application/header.html' /}
<h2>マイページ</h2>

%{
	// SimpleDateFormat sdf = new SimpleDateFormat("MM/dd");
}%

<div id="news-block" class="sans-serif">
	<h3>お知らせ</h3>
	<p class="note">2件のお知らせがあります。</p>
	<a class="seeMore" href="@{news()}">過去のお知らせを見る</a>
	<table class="table table-bordered">
		<tbody>
			<tr>
				<td>12/18</td>
				<td>プロジェクト「<a href="@{project()}">H26 情報工学科研究室振り分け</a>」に招待されました。</td>
			</tr>
			<tr>
				<td>12/17</td>
				<td>プロジェクト「<a href="@{project()}">H26 情報工学科研究室振り分け</a>」の結果が出ました。</td>
			</tr>
		</tbody>
	</table>
</div>

<form action="makeProject" style="display:inline">
	<input class="makeproject-btn btn" type="submit" value="プロジェクト作成">
</form>

<button type="button" class="inputinvitationcode-btn btn" data-toggle="modal" data-target="#input-invitation-code-modal">招待コード入力</button>

<div id="invited-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>招待されているプロジェクト</h3>
	#{if InR.size()==0 && IR.size()==0}
	<p>プロジェクトはありません。</p>
	#{/if}
	#{else}
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>締め切り</th>
				<th>登録</th>
			</tr>
			<!-- 招待された登録新規 -->
			<tr id="by-invitation-code">
			</tr>
			<!-- 招待された登録未完了 -->
			#{list items:InR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.deadline.getMonth()+1}/${ele.deadline.getDate()}</td>
				<td class="column-3"><a class="register-btn btn" href="@{register(ele.id)}">登録する</a></td>
			</tr>
			#{/list}
			<!-- 招待された登録完了 -->
			#{list items:IR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.deadline.getMonth()+1}/${ele.deadline.getDate()}</td>
				<td class="column-3">登録済み</td>
			</tr>
			#{/list}
			<!-- <tr>
				<td class="column-1"><a href="@{project()}">H26 情報工学科研究室振り分け</a></td>
				<td class="column-2">12/18</td>
				<td class="column-3"><a class="register-btn btn" href="@{register()}">登録する</a></td>
			</tr>
			<tr>
				<td class="column-1"><a href="@{project()}">グループ振り分け</a></td>
				<td class="column-2">12/18</td>
				<td class="column-3">登録済み</td>
			</tr> -->
		</tbody>
	</table>
	#{/else}
</div>

<div id="created-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>作成したプロジェクト</h3>
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>締め切り</th>
				<th>登録</th>
			</tr>
			#{list items:MP, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2">${ele.deadline.getMonth()+1}/${ele.deadline.getDate()}</td>
				<td class="column-3"><a class="edit-btn btn" href="@{editProject(ele.id)}">編集する</a></td>
			</tr>
			#{/list}
			<!-- <tr>
				<td class="column-1"><a href="@{project()}">グループ振り分け</a></td>
				<td class="column-2">終了</td>
				<td class="column-3"><a class="result-btn btn" href="@{result()}">結果を見る</a></td>
			</tr> -->
		</tbody>
	</table>
</div>

<div id="join-projects-block" class="projects-block">
	<div class="view-toggle"><i class="fa fa-caret-up"></i></div>
	<h3>参加したプロジェクト</h3>
	#{if FnR.size()==0 && FR.size()==0}
	<p>プロジェクトはありません。</p>
	#{/if}
	#{else}
	<table class="table table-bordered project-table">
		<tbody>
			<tr>
				<th>プロジェクト</th>
				<th>あなたのグループ</th>
				<th>登録</th>
			</tr>
			<!-- 終了した登録未完了 -->
			#{list items:FnR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2"></td>
				<td class="column-3"><a class="result-btn btn" href="@{result()}">結果を見る</a></td>
			</tr>
			#{/list}
			<!-- 終了した登録完了 -->
			#{list items:FR, as : 'ele'}
			<tr>
				<td class="column-1"><a href="@{project(ele.id)}">${ele.name}</a></td>
				<td class="column-2"></td>
				<td class="column-3"><a class="result-btn btn" href="@{result()}">結果を見る</a></td>
			</tr>
			#{/list}
		</tbody>
	</table>
	#{/else}

</div>

<!-- 招待コード入力 Modal -->
<div class="modal fade" id="input-invitation-code-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h3 class="modal-title" id="myModalLabel">招待コード入力</h3>
      </div>
      <div class="modal-body">
    <div class="input-group">
      <span class="input-group-addon">招待コード</span>
      <input class="form form-control" type="text" name="invitation_code">
    </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
        <button id="input-invitation-code-btn" type="button" class="btn btn-primary" disabled data-dismiss="modal">送信する</button>
      </div>
    </div>
  </div>
</div>
